<div class="assess-container">
  <div class="assess-content">
    <!-- Header Card -->
    <div class="header-card">
      <mat-card>
        <mat-card-header>
          <mat-card-title>Assessment Center</mat-card-title>
          <mat-card-subtitle>Evaluate your readiness for technical interviews</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <p>Take comprehensive assessments to gauge your technical skills and interview readiness.</p>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Tabs for different sections -->
    <mat-tab-group class="assess-tabs" dynamicHeight>
      <!-- OVERVIEW TAB -->
      <mat-tab label="ğŸ“Š Overview" class="overview-tab">
        <ng-template mat-tab-label>
          <span class="tab-icon">ğŸ“Š</span>
          <span>Overview</span>
        </ng-template>

        <div class="tab-content">
          <div *ngIf="isLoadingOverview" class="loading-container">
            <mat-spinner diameter="40"></mat-spinner>
            <p>Loading overview...</p>
          </div>

          <div *ngIf="!isLoadingOverview && overview" class="overview-section">
            <div class="stats-grid">
              <mat-card class="stat-card">
                <mat-card-content>
                  <div class="stat-icon">âœ…</div>
                  <div class="stat-info">
                    <h3>{{ overview.completedCount }}</h3>
                    <p>Assessments Completed</p>
                  </div>
                </mat-card-content>
              </mat-card>

              <mat-card class="stat-card">
                <mat-card-content>
                  <div class="stat-icon">ğŸ“ˆ</div>
                  <div class="stat-info">
                    <h3>{{ overview.averageScore }}%</h3>
                    <p>Average Score</p>
                  </div>
                </mat-card-content>
              </mat-card>

              <mat-card class="stat-card">
                <mat-card-content>
                  <div class="stat-icon">â±ï¸</div>
                  <div class="stat-info">
                    <h3>{{ overview.averageTime }}h</h3>
                    <p>Average Time</p>
                  </div>
                </mat-card-content>
              </mat-card>

              <mat-card class="stat-card">
                <mat-card-content>
                  <div class="stat-icon">ğŸ¯</div>
                  <div class="stat-info">
                    <h3>{{ overview.totalAttempts }}</h3>
                    <p>Total Attempts</p>
                  </div>
                </mat-card-content>
              </mat-card>
            </div>
          </div>
        </div>
      </mat-tab>

      <!-- ALL ASSESSMENTS TAB -->
      <mat-tab label="ğŸ“ All Assessments" class="assessments-tab">
        <ng-template mat-tab-label>
          <span class="tab-icon">ğŸ“</span>
          <span>All Assessments</span>
        </ng-template>

        <div class="tab-content">
          <div *ngIf="isLoadingAssessments" class="loading-container">
            <mat-spinner diameter="40"></mat-spinner>
            <p>Loading assessments...</p>
          </div>

          <div *ngIf="!isLoadingAssessments && assessments.length === 0" class="empty-state">
            <p>No assessments available.</p>
          </div>

          <div *ngIf="!isLoadingAssessments && assessments.length > 0" class="assessments-grid">
            <mat-card class="assessment-item" *ngFor="let assessment of assessments">
              <mat-card-header>
                <div class="assessment-title-section">
                  <mat-card-title>{{ assessment.title }}</mat-card-title>
                  <mat-chip-set>
                    <mat-chip [color]="getDifficultyColor(assessment.difficulty)" selected>
                      {{ assessment.difficulty | titlecase }}
                    </mat-chip>
                  </mat-chip-set>
                </div>
              </mat-card-header>

              <mat-card-content>
                <p class="description">{{ assessment.description }}</p>

                <div class="metadata">
                  <mat-chip-set>
                    <mat-chip>â±ï¸ {{ formatDuration(assessment.duration) }}</mat-chip>
                    <mat-chip>â“ {{ assessment.questionCount }} Q</mat-chip>
                    <mat-chip>ğŸ“Š Category: {{ assessment.category }}</mat-chip>
                    <mat-chip *ngIf="assessment.bestScore">
                      ğŸ† Best: {{ assessment.bestScore }}%
                    </mat-chip>
                  </mat-chip-set>
                </div>

                <div *ngIf="assessment.lastAttempted" class="last-attempted">
                  <small>Last attempted: {{ assessment.lastAttempted }}</small>
                </div>
              </mat-card-content>

              <mat-card-actions>
                <button mat-raised-button color="primary" (click)="startAssessment(assessment)">
                  Start Assessment
                </button>
                <button mat-stroked-button *ngIf="assessment.bestScore">
                  View Results
                </button>
              </mat-card-actions>
            </mat-card>
          </div>
        </div>
      </mat-tab>

      <!-- RESULTS TAB -->
      <mat-tab label="ğŸ“‹ Results" class="results-tab">
        <ng-template mat-tab-label>
          <span class="tab-icon">ğŸ“‹</span>
          <span>Results</span>
        </ng-template>

        <div class="tab-content">
          <div *ngIf="isLoadingResults" class="loading-container">
            <mat-spinner diameter="40"></mat-spinner>
            <p>Loading results...</p>
          </div>

          <div *ngIf="!isLoadingResults && assessmentResults.length === 0" class="empty-state">
            <p>No assessment results yet. Start an assessment to see results here.</p>
          </div>

          <div *ngIf="!isLoadingResults && assessmentResults.length > 0" class="results-list">
            <mat-card class="result-item" *ngFor="let result of assessmentResults">
              <mat-card-content>
                <div class="result-header">
                  <div class="result-title">
                    <h4>{{ result.title }}</h4>
                    <span class="difficulty" [class]="result.difficulty.toLowerCase()">
                      {{ result.difficulty }}
                    </span>
                  </div>
                  <div class="result-score" [class.passed]="result.passed" [class.failed]="!result.passed">
                    <mat-icon>{{ result.passed ? 'check_circle' : 'cancel' }}</mat-icon>
                    <span>{{ result.score.toFixed(1) }}%</span>
                  </div>
                </div>

                <div class="result-stats">
                  <span>âœ… {{ result.correctAnswers }} / {{ result.totalQuestions }} Correct</span>
                  <span>â±ï¸ {{ result.duration }} minutes</span>
                  <span>ğŸ“… {{ result.completedDate }}</span>
                </div>

                <mat-progress-bar
                  mode="determinate"
                  [value]="result.percentage"
                  [color]="result.passed ? 'primary' : 'warn'"
                ></mat-progress-bar>

                <div class="result-actions">
                  <button mat-stroked-button (click)="viewResults(result)">
                    View Details
                  </button>
                  <button mat-stroked-button (click)="retakeAssessment(result)">
                    Retake
                  </button>
                </div>
              </mat-card-content>
            </mat-card>
          </div>
        </div>
      </mat-tab>

      <!-- RECOMMENDED TAB -->
      <mat-tab label="ğŸ’¡ Recommended" class="recommended-tab">
        <ng-template mat-tab-label>
          <span class="tab-icon">ğŸ’¡</span>
          <span>Recommended</span>
        </ng-template>

        <div class="tab-content">
          <div *ngIf="isLoadingRecommended" class="loading-container">
            <mat-spinner diameter="40"></mat-spinner>
            <p>Loading recommendations...</p>
          </div>

          <div *ngIf="!isLoadingRecommended && recommendedAssessments.length === 0" class="empty-state">
            <p>No recommendations available at this time.</p>
          </div>

          <div *ngIf="!isLoadingRecommended && recommendedAssessments.length > 0" class="assessments-grid">
            <mat-card class="assessment-item recommended" *ngFor="let assessment of recommendedAssessments">
              <mat-card-header>
                <div class="recommended-badge">
                  <mat-icon>recommended</mat-icon>
                  <span>Recommended</span>
                </div>
                <div class="assessment-title-section">
                  <mat-card-title>{{ assessment.title }}</mat-card-title>
                  <mat-chip-set>
                    <mat-chip [color]="getDifficultyColor(assessment.difficulty)" selected>
                      {{ assessment.difficulty | titlecase }}
                    </mat-chip>
                  </mat-chip-set>
                </div>
              </mat-card-header>

              <mat-card-content>
                <p class="description">{{ assessment.description }}</p>

                <div class="metadata">
                  <mat-chip-set>
                    <mat-chip>â±ï¸ {{ formatDuration(assessment.duration) }}</mat-chip>
                    <mat-chip>â“ {{ assessment.questionCount }} Q</mat-chip>
                    <mat-chip>ğŸ“Š Category: {{ assessment.category }}</mat-chip>
                  </mat-chip-set>
                </div>

                <div class="recommendation-reason">
                  <strong>Why this assessment?</strong>
                  <p>Based on your performance, we recommend this assessment to improve your weak areas.</p>
                </div>
              </mat-card-content>

              <mat-card-actions>
                <button mat-raised-button color="accent" (click)="startAssessment(assessment)">
                  Take This Assessment
                </button>
              </mat-card-actions>
            </mat-card>
          </div>
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>
</div>
